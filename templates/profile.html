{% extends 'base.html' %}

{% block content %}
    <!-- Profile Header -->
    <div class="profile-header" style="background-color: #00C853; color: white; padding: 20px; text-align: center; position: relative;">
        <div class="profile-picture" style="width: 100px; height: 100px; border-radius: 50%; background-color: white; margin: 0 auto 15px; overflow: hidden; border: 3px solid white;">
            <img src="{{ url_for('static', filename='images/avatar.png') }}" alt="Profile Picture" style="width: 100%; height: 100%; object-fit: cover;" onerror="this.src='https://via.placeholder.com/100?text=User'">
        </div>
        <h2 id="profile-name" style="margin-bottom: 5px; font-size: 1.5rem;">John Doe</h2>
        <p id="profile-phone" style="margin-bottom: 15px; opacity: 0.9; font-size: 0.9rem;">+233 55 123 4567</p>
        <button id="edit-profile-button" style="background-color: rgba(255,255,255,0.2); color: white; border: none; padding: 8px 15px; border-radius: 20px; font-size: 0.9rem; cursor: pointer;">
            Edit Profile
        </button>
    </div>
    
    <!-- Profile Stats -->
    <div class="profile-stats" style="display: flex; background-color: white; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
        <div style="flex: 1; text-align: center; padding: 15px; border-right: 1px solid #EEEEEE;">
            <div style="font-weight: bold; font-size: 1.2rem;">12</div>
            <div style="color: #757575; font-size: 0.8rem;">Rides</div>
        </div>
        <div style="flex: 1; text-align: center; padding: 15px; border-right: 1px solid #EEEEEE;">
            <div style="font-weight: bold; font-size: 1.2rem;">5</div>
            <div style="color: #757575; font-size: 0.8rem;">Orders</div>
        </div>
        <div style="flex: 1; text-align: center; padding: 15px;">
            <div style="font-weight: bold; font-size: 1.2rem;">4.8</div>
            <div style="color: #757575; font-size: 0.8rem;">Rating</div>
        </div>
    </div>
    
    <!-- Profile Menu -->
    <div class="profile-menu" style="background-color: white; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
        <div class="menu-item" style="padding: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #EEEEEE; cursor: pointer;">
            <div style="display: flex; align-items: center;">
                <div style="width: 40px; height: 40px; background-color: #F5F5F5; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                    <span style="font-size: 1.2rem;">ðŸ’³</span>
                </div>
                <div>Payment Methods</div>
            </div>
            <span style="color: #757575;">â€º</span>
        </div>
        
        <div class="menu-item" style="padding: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #EEEEEE; cursor: pointer;">
            <div style="display: flex; align-items: center;">
                <div style="width: 40px; height: 40px; background-color: #F5F5F5; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                    <span style="font-size: 1.2rem;">ðŸ’¬</span>
                </div>
                <div>Support</div>
            </div>
            <span style="color: #757575;">â€º</span>
        </div>
        
        <div class="menu-item" style="padding: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #EEEEEE; cursor: pointer;">
            <div style="display: flex; align-items: center;">
                <div style="width: 40px; height: 40px; background-color: #F5F5F5; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                    <span style="font-size: 1.2rem;">ðŸ”’</span>
                </div>
                <div>Privacy & Security</div>
            </div>
            <span style="color: #757575;">â€º</span>
        </div>
        
        <div class="menu-item" style="padding: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #EEEEEE; cursor: pointer;">
            <div style="display: flex; align-items: center;">
                <div style="width: 40px; height: 40px; background-color: #F5F5F5; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px;">
                    <span style="font-size: 1.2rem;">ðŸ“±</span>
                </div>
                <div>App Settings</div>
            </div>
            <span style="color: #757575;">â€º</span>
        </div>
    </div>
    
    <!-- Recent Activity -->
    <div class="recent-activity" style="padding: 15px;">
        <h3 style="margin-bottom: 15px; font-size: 1.2rem;">Recent Activity</h3>
        
        <div class="activity-item" style="background-color: white; border-radius: 8px; padding: 15px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                <div style="font-weight: bold;">Ride to Adeiso Health Center</div>
                <div style="color: #757575; font-size: 0.8rem;">Today</div>
            </div>
            <div style="display: flex; justify-content: space-between; color: #757575; font-size: 0.9rem;">
                <div>GHâ‚µ 25</div>
                <div>Completed</div>
            </div>
        </div>
        
        <div class="activity-item" style="background-color: white; border-radius: 8px; padding: 15px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                <div style="font-weight: bold;">Food Order - Adeiso Pizza</div>
                <div style="color: #757575; font-size: 0.8rem;">Yesterday</div>
            </div>
            <div style="display: flex; justify-content: space-between; color: #757575; font-size: 0.9rem;">
                <div>GHâ‚µ 45</div>
                <div>Delivered</div>
            </div>
        </div>
        
        <div class="activity-item" style="background-color: white; border-radius: 8px; padding: 15px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                <div style="font-weight: bold;">Ride to Adeiso Market</div>
                <div style="color: #757575; font-size: 0.8rem;">3 days ago</div>
            </div>
            <div style="display: flex; justify-content: space-between; color: #757575; font-size: 0.9rem;">
                <div>GHâ‚µ 18</div>
                <div>Completed</div>
            </div>
        </div>
    </div>
    
    <!-- Logout Button -->
    <div style="padding: 15px;">
        <button id="logout-button" style="width: 100%; padding: 15px; background-color: #F5F5F5; color: #F44336; border: none; border-radius: 8px; font-size: 1rem; font-weight: bold; cursor: pointer;">
            Logout
        </button>
    </div>
    
    <!-- Edit Profile Modal (Hidden by default) -->
    <div id="edit-profile-modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(0,0,0,0.5); z-index: 1000;">
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: white; width: 90%; max-width: 400px; border-radius: 8px; padding: 20px;">
            <h3 style="margin-bottom: 20px; text-align: center;">Edit Profile</h3>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; color: #757575;">Full Name</label>
                <input type="text" value="John Doe" style="width: 100%; padding: 10px; border: 1px solid #E0E0E0; border-radius: 5px;">
            </div>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; color: #757575;">Phone Number</label>
                <input type="tel" value="+233 55 123 4567" style="width: 100%; padding: 10px; border: 1px solid #E0E0E0; border-radius: 5px;">
            </div>
            
            <div style="margin-bottom: 15px;">
                <label style="display: block; margin-bottom: 5px; color: #757575;">Email</label>
                <input type="email" value="john.doe@example.com" style="width: 100%; padding: 10px; border: 1px solid #E0E0E0; border-radius: 5px;">
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button id="cancel-edit-button" style="flex: 1; padding: 12px; border: none; background-color: #F5F5F5; color: #212121; border-radius: 5px; cursor: pointer;">
                    Cancel
                </button>
                <button id="save-profile-button" style="flex: 1; padding: 12px; border: none; background-color: #00C853; color: white; border-radius: 5px; cursor: pointer;">
                    Save Changes
                </button>
            </div>
        </div>
    </div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Load user data from session storage
        const storedUserData = sessionStorage.getItem('orda_user');
        
        if (storedUserData) {
            const userData = JSON.parse(storedUserData);
            
            // Update profile information
            const profileName = document.getElementById('profile-name');
            const profilePhone = document.getElementById('profile-phone');
            
            if (profileName && userData.name) {
                profileName.textContent = userData.name;
            }
            
            if (profilePhone && userData.phone) {
                profilePhone.textContent = userData.phone;
            }
            
            // Update form fields in the edit modal
            const nameInput = document.querySelector('input[type="text"]');
            const phoneInput = document.querySelector('input[type="tel"]');
            const emailInput = document.querySelector('input[type="email"]');
            
            if (nameInput && userData.name) {
                nameInput.value = userData.name;
            }
            
            if (phoneInput && userData.phone) {
                phoneInput.value = userData.phone;
            }
            
            if (emailInput && userData.email) {
                emailInput.value = userData.email;
            }
        }
        
        // Edit Profile Modal
        const editProfileButton = document.getElementById('edit-profile-button');
        const editProfileModal = document.getElementById('edit-profile-modal');
        const cancelEditButton = document.getElementById('cancel-edit-button');
        const saveProfileButton = document.getElementById('save-profile-button');
        
        editProfileButton.addEventListener('click', function() {
            editProfileModal.style.display = 'block';
        });
        
        cancelEditButton.addEventListener('click', function() {
            editProfileModal.style.display = 'none';
        });
        
        saveProfileButton.addEventListener('click', function() {
            // Get the updated values
            const nameInput = document.querySelector('input[type="text"]');
            const phoneInput = document.querySelector('input[type="tel"]');
            const emailInput = document.querySelector('input[type="email"]');
            
            // Get existing user data
            const storedUserData = sessionStorage.getItem('orda_user');
            let userData = storedUserData ? JSON.parse(storedUserData) : {};
            
            // Update the user data
            userData.name = nameInput.value;
            userData.phone = phoneInput.value;
            userData.email = emailInput.value;
            
            // Save back to session storage
            sessionStorage.setItem('orda_user', JSON.stringify(userData));
            
            // Update the profile display
            const profileName = document.getElementById('profile-name');
            const profilePhone = document.getElementById('profile-phone');
            
            if (profileName) {
                profileName.textContent = userData.name;
            }
            
            if (profilePhone) {
                profilePhone.textContent = userData.phone;
            }
            
            // Show success message
            alert('Profile updated successfully!');
            editProfileModal.style.display = 'none';
        });
        
        // Menu Items
        const menuItems = document.querySelectorAll('.menu-item');
        
        menuItems.forEach(item => {
            item.addEventListener('click', function() {
                const menuText = this.querySelector('div > div:last-child').textContent.trim();
                alert(`You selected: ${menuText}\n\nThis feature is coming soon!`);
            });
        });
        
        // Activity Items
        const activityItems = document.querySelectorAll('.activity-item');
        
        activityItems.forEach(item => {
            item.addEventListener('click', function() {
                const activityTitle = this.querySelector('div > div:first-child').textContent.trim();
                alert(`You selected: ${activityTitle}\n\nActivity details coming soon!`);
            });
        });
        
        // Logout Button
        const logoutButton = document.getElementById('logout-button');
        
        logoutButton.addEventListener('click', function() {
            if (confirm('Are you sure you want to logout?')) {
                // Redirect to logout route
                window.location.href = '/logout';
            }
        });
    });
</script>
{% endblock %}
